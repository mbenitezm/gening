<!DOCTYPE HTML>
<html>
<head>
    <script src="http://canvasjs.com/assets/script/canvasjs.min.js"></script>

    <script type="text/javascript">

        window.onload = function () {
            $.ajax({
                type: "GET",
                url: "/reports/date_statistics",
                success: function(response){
                  console.log(response.onTime);
                    var chart = new CanvasJS.Chart("chartContainer", {
                        title:{
                            text: "Dates of delivered products"
                        },
                        data: [
                            {
                                type: "pie",
                                indexLabel: "#percent%",
                                dataPoints: [
                                  { label: "On time delivered orders",  y: response.onTime  },
                                  { label: "Delayed delivered orders", y: response.delayed  },
                                ]
                            }
                        ]
                    });
                    chart.render();
                },
                error: function(data){
                    console.log("error");
                }
            });

        }
    </script>
</head>
<body>
<h1>Deliveries</h1>
<div id="chartContainer" style="height: 300px; width: 100%;"></div>
<%= will_paginate @data %>
<table class="table table-striped">                         
  <tr>                          
    <th>Order number</th>
    <th>Customer number</th>
    <th>Order date</th>
    <th>Desired ship date</th>
    <th>Last ship date</th>
    <th>Promised date</th>
  </tr>
<% @data.each do |data| %>      
  <tr>
    <td><%= data.number %></td>  
    <td><%= data.customer_number %></td>
    <td><%= data.order_date %></td>  
    <td><%= data.desired_ship_date %></td> 
    <td><%= data.last_ship_date %></td>  
    <td><%= data.promised_date%></td> 
  </tr>
<% end %>                        
</table> 
<%= will_paginate @data %>
</body>
</html>